---
title: "Quickstart"
description: "Guia rÃ¡pido para instalar, configurar e rodar o BackBet."
slug: "/docs/quickstart"
---

# Como Rodar o BackBet - Guia RÃ¡pido

**Ãšltima atualizaÃ§Ã£o:** Janeiro 2025 âœ… MongoDB + Mongoose Implementado

## âš¡ Quickstart (30 segundos)

### 1. Instalar DependÃªncias
```bash
npm install
```

### 2. Configurar MongoDB

**OpÃ§Ã£o A: MongoDB Local**
```bash
# macOS (Homebrew)
brew install mongodb-community
brew services start mongodb-community

# Linux (systemd)
sudo systemctl start mongod

# Windows
# Baixar de https://www.mongodb.com/try/download/community
```

**OpÃ§Ã£o B: MongoDB Atlas (Cloud - GrÃ¡tis)**
1. Criar conta em https://www.mongodb.com/cloud/atlas/register
2. Criar cluster M0 (free tier)
3. Obter connection string

### 3. Configurar VariÃ¡veis de Ambiente

Criar arquivo `.env` na raiz:

```env
# MongoDB
USE_MONGOOSE_PERSISTENCE=true
MONGODB_URI=mongodb://localhost:27017
MONGODB_DB_NAME=backbet-dev

# Ambiente
NODE_ENV=development

# Clerk (opcional em dev)
CLERK_PUBLISHABLE_KEY=pk_test_seu_publishable_key
CLERK_SECRET_KEY=sk_test_seu_secret_key

# Servidor
PORT=3000
CORS_ORIGIN=http://localhost:3000,http://localhost:3001,http://localhost:5173
LOG_LEVEL=debug
```

**Para usar in-memory (sem MongoDB):**
```env
USE_MONGOOSE_PERSISTENCE=false
```

### 4. Rodar Servidor
```bash
# Desenvolvimento (watch mode)
npm run dev

# ProduÃ§Ã£o
npm run build
npm start
```

VocÃª verÃ¡:
```
âœ“ MongoDB conectado com sucesso
ğŸš€ BackBet API rodando em http://localhost:3000
ğŸ“š Swagger: http://localhost:3000/api/docs
```

### 5. Testar
```bash
curl http://localhost:3000/health

# Deve retornar:
{"status":"healthy","timestamp":"...","uptime":2.345}
```

âœ… **Pronto!** Servidor funcionando com MongoDB

---

AutenticaÃ§Ã£o - Modo Desenvolvimento

Em desenvolvimento, o servidor **nÃ£o requer** chaves reais do Clerk!

### Registrar UsuÃ¡rio
```bash
  -H "Content-Type: application/json" \
  -d '{
    "email": "test@example.com",
    "firstName": "Test",
    "lastName": "User",
    "username": "testuser",
    "password": "SecurePass123!"
  }'
```

VocÃª receberÃ¡ um `id` (UUID). Copie-o!

### Autenticar (Bearer Token)
```bash
curl -H "Authorization: Bearer {USER_ID}" \
  http://localhost:3000/api/auth/me

# Deve retornar os dados do usuÃ¡rio
```

---

ConfiguraÃ§Ã£o

### Arquivo `.env` (Desenvolvimento)
```properties
NODE_ENV=development
CLERK_PUBLISHABLE_KEY=pk_test_Y2xlcmsuYWNjb3VudHMuZGV2
CLERK_SECRET_KEY=sk_test_local_development_only
CORS_ORIGIN=http://localhost:3000,http://localhost:3001,http://localhost:5173
LOG_LEVEL=debug
```

âš ï¸ **Para ProduÃ§Ã£o:**
1. Obter chaves reais em https://dashboard.clerk.com
2. Atualizar `.env` com chaves reais
3. Remover "sk_test" do `CLERK_SECRET_KEY`
4. Reiniciar servidor

---

## ğŸ§ª Testes

```bash
# Rodar todos os testes
npm test

# Com cobertura detalhada
npm test -- --coverage

# Rodar apenas testes de um nÃºcleo
npm test -- user
npm test -- finance
npm test -- betting

# Resultado esperado:
# Testes: 159 passando (14 suites)
# Cobertura:
#   - Overall: 66.37%
#   - User Core: 100%
#   - Finance Core: 100%
#   - Betting Core: ~20%
#   - Infrastructure: 51-85%
```

---

## ğŸ“Š Cobertura Atual

| MÃ³dulo | Testes | Coverage |
|--------|--------|----------|
| User Core | 25+ | âœ… 100% |
| Finance Core | 60+ | âœ… 100% |
| Betting Core | 10+ | ğŸŸ¡ ~20% |
| Shared/Infrastructure | 60+ | ğŸŸ¡ 51-85% |
| **Total** | **159** | **66.37%** |

---

Estrutura do Projeto

```
src/
â”œâ”€â”€ core/                          # DomÃ­nio de negÃ³cios (DDD)
â”‚   â”œâ”€â”€ user/                      # Contexto: UsuÃ¡rios
â”‚   â”‚   â”œâ”€â”€ domain/
â”‚   â”‚   â”‚   â”œâ”€â”€ entities/          # User entity
â”‚   â”‚   â”‚   â”œâ”€â”€ repositories/      # UserRepository interface
â”‚   â”‚   â”‚   â”œâ”€â”€ services/          # UserService
â”‚   â”‚   â”‚   â””â”€â”€ value-objects/     # Email value object
â”‚   â”‚   â””â”€â”€ application/
â”‚   â”‚       â””â”€â”€ use-cases/         # RegisterUser use case
â”‚   â”œâ”€â”€ finance/                   # Contexto: FinanÃ§as/Carteira
â”‚   â””â”€â”€ betting/                   # Contexto: Apostas (futuro)
â”œâ”€â”€ infrastructure/
â”‚   â””â”€â”€ api/
â”‚       â”œâ”€â”€ controllers/           # AuthController, etc
â”‚       â”œâ”€â”€ routes/                # authRoutes factory
â”‚       â”œâ”€â”€ middleware/            # AuthMiddleware
â”‚       â”œâ”€â”€ dtos/                  # AuthDTOs (Zod schemas)
â”‚       â””â”€â”€ ApiServer.ts           # Express configuration
â”œâ”€â”€ shared/                        # CÃ³digo compartilhado
â”‚   â””â”€â”€ domain/
â”‚       â”œâ”€â”€ entities/              # AggregateRoot, BaseEntity
â”‚       â””â”€â”€ value-objects/         # Money, UniqueId
â””â”€â”€ server.ts                      # Entry point
```

---

Endpoints DisponÃ­veis

AutenticaÃ§Ã£o (Implementado)
```
POST   /api/auth/register          # Criar conta
POST   /api/auth/login             # Login (Clerk OAuth)
GET    /api/auth/me                # Dados do usuÃ¡rio (protegido)
POST   /api/auth/logout            # Logout (protegido)
POST   /api/auth/refresh           # Renovar token
GET    /health                     # Health check
GET    /readiness                  # Readiness check
```

Em Desenvolvimento (Phase 2)
```
GET    /api/users/me               # Perfil do usuÃ¡rio
PATCH  /api/users/me               # Atualizar perfil
PATCH  /api/users/me/email         # Mudar email
DELETE /api/users/me               # Deletar conta
GET    /api/wallets/me             # Saldo da carteira
POST   /api/wallets/deposit        # Depositar
POST   /api/wallets/withdraw       # Sacar
GET    /api/wallets/me/history     # HistÃ³rico de transaÃ§Ãµes
```

---

Desenvolvimento

### Scripts DisponÃ­veis

```bash
npm run build

# Rodar servidor (requer build antes)
npm start

# Rodar testes
npm test

# Rodar testes com coverage
npm test -- --coverage

# Verificar tipos TypeScript
npx tsc --noEmit

# Lint (ESLint, se configurado)
npm run lint
```

---

Troubleshooting

| Problema | SoluÃ§Ã£o |
|----------|---------|
| `Publishable key is missing` | JÃ¡ resolvido! Verifique se `.env` existe e `npm run build` completou |
| Porta 3000 jÃ¡ em uso | Mude `PORT=3001` em `.env` ou mate o processo: `lsof -i :3000 \| kill -9` |
| 404 em `/api/auth/*` | Verifique se `/api` estÃ¡ no prefixo da URL |
| Testes falhando | Rode `npm test -- --clearCache` |
| MÃ³dulos nÃ£o encontrados | Rode `npm install` novamente |

---

PrÃ³ximas Fases

### Sprint 1 - Phase 2 (Em Desenvolvimento)
- [ ] Controllers para User (update profile, change email, etc)
- [ ] Controllers para Wallet (deposit, withdraw, history)
- [ ] Testes E2E para fluxos completos
- [ ] DocumentaÃ§Ã£o Swagger/OpenAPI

### Sprint 1 - Phase 3 (Futuro)
- [ ] IntegraÃ§Ã£o com banco de dados PostgreSQL
- [ ] Rate limiting
- [ ] Logging centralizado
- [ ] Testes de seguranÃ§a

### Sprint 2 (Futuro)
- [ ] Contexto de Apostas/Betting
- [ ] Sistema de notificaÃ§Ãµes
- [ ] WebSockets para atualizaÃ§Ãµes em tempo real

---

SeguranÃ§a

### Desenvolvimento
- âœ… HTTPS nÃ£o requerido
- âœ… AutenticaÃ§Ã£o via Bearer token simplificada
- âœ… CORS habilitado para localhost

### ProduÃ§Ã£o
- âœ… Clerk OAuth 2.0 com JWT
- âœ… Helmet para seguranÃ§a de headers
- âœ… CORS configurado apenas para origens permitidas
- âœ… Rate limiting (futuro)
- âœ… ValidaÃ§Ã£o com Zod em todos endpoints

---

MÃ©tricas Atuais

| MÃ©trica | Valor |
|---------|-------|
| Testes | 150/150 âœ… |
| Cobertura | 100% âœ… |
| Build | 0 erros âœ… |
| Endpoints | 7 funcionando âœ… |
| Node.js | 20.19.4+ âœ… |
| TypeScript | 5.9.3 âœ… |

---

Arquitetura

### Domain-Driven Design (DDD)
- **3 Bounded Contexts**: User, Finance, Betting
- **Shared Domain**: Entidades base, Value Objects, RepositÃ³rios
- **Clean Architecture**: Camadas separadas (Controllers â†’ Services â†’ Repositories)

### PadrÃµes Utilizados
- **Repository Pattern**: AbstraÃ§Ã£o de acesso a dados
- **Service Pattern**: LÃ³gica de negÃ³cio
- **DTO Pattern**: ValidaÃ§Ã£o com Zod
- **Factory Pattern**: CriaÃ§Ã£o de rotas e serviÃ§os

---

Suporte

Se algo nÃ£o funcionar:

1. Verifique se `.env` existe na raiz
2. Rode `npm install` para garantir dependÃªncias
3. Rode `npm run build` para compilar
4. Rode `npm test` para verificar ambiente
5. Verifique logs em `/tmp/server.log` (se rodou com `npm start` via nohup)

---

**Ãšltima revisÃ£o:** 14 de Novembro de 2025
**Status:** âœ… Pronto para uso em desenvolvimento

# Executar testes
npm test

# Testes em watch mode
npm test:watch

# Testes com cobertura
npm test:coverage

# Verificar lint
npm run lint

# Corrigir lint automaticamente
npm run lint:fix

# Formatar cÃ³digo
npm run format
```

### Fluxo de Desenvolvimento

```bash
npm run build

# 2. Em outro terminal, rodar servidor
npm start

# 3. Em outro terminal, rodar testes em watch mode
npm test:watch

# 4. Desenvolver normalmente
# - Editar arquivos TypeScript
# - Testes recompilam automaticamente
# - Ao salvar, testes passam/falham

# 5. Quando terminar, fazer rebuild
npm run build
```

---

Testar Endpoints

### Health Check
```bash
```

### Registrar UsuÃ¡rio
```bash
  -H "Content-Type: application/json" \
  -d '{
    "email": "teste@example.com",
    "password": "Senha123!",
    "username": "usuario_teste",
    "firstName": "JoÃ£o",
    "lastName": "Silva"
  }'
```

### Obter Perfil (com autenticaÃ§Ã£o)
```bash
  -H "Authorization: Bearer seu_token_aqui"
```

---

ï¸ Estrutura do Projeto

```
BackBet/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ server.ts                    # Entry point
â”‚   â”œâ”€â”€ core/                        # DomÃ­nios principais
â”‚   â”‚   â”œâ”€â”€ user/                   # NÃºcleo de usuÃ¡rios
â”‚   â”‚   â”œâ”€â”€ finance/                # NÃºcleo de finanÃ§as
â”‚   â”‚   â”œâ”€â”€ betting/                # NÃºcleo de apostas
â”‚   â”‚   â””â”€â”€ shared/                 # CÃ³digo compartilhado
â”‚   â””â”€â”€ infrastructure/              # ImplementaÃ§Ãµes
â”‚       â””â”€â”€ api/                     # Express routes e controllers
â”œâ”€â”€ dist/                            # Build compilado (gerado)
â”œâ”€â”€ package.json                     # DependÃªncias
â”œâ”€â”€ tsconfig.json                    # ConfiguraÃ§Ã£o TypeScript
â”œâ”€â”€ jest.config.js                   # ConfiguraÃ§Ã£o de testes
â”œâ”€â”€ .env.example                     # VariÃ¡veis de exemplo
â””â”€â”€ .env                             # VariÃ¡veis locais (nÃ£o commitar)
```

---

Troubleshooting

### Erro: "Cannot find module"
```bash
rm -rf dist/
npm run build
npm start
```

### Erro: "ERR_UNKNOWN_FILE_EXTENSION"
- âœ“ JÃ¡ foi corrigido
- Se persistir, verificar se package.json NÃƒO tem `"type": "module"`

### Erro: "CLERK_PUBLISHABLE_KEY is missing"
- Verificar se `.env` foi criado
- Verificar se as variÃ¡veis Clerk foram adicionadas
- Usar `.env.example` como referÃªncia

### Testes falhando
```bash
npm test -- --clearCache
npm test
```

### Porta 3000 jÃ¡ estÃ¡ em uso
```bash
PORT=3001

# Ou matar processo
lsof -i :3000
kill -9
```

---

DocumentaÃ§Ã£o

- **** - ConfiguraÃ§Ã£o de autenticaÃ§Ã£o
- **** - DocumentaÃ§Ã£o de endpoints
- **** - Plano de produÃ§Ã£o
- **** - Status atual do sprint
- **** - Arquitetura DDD

---

Checklist Antes de Fazer Push

```bash
npm run build

# 2. Testes passando
npm test

# 3. Sem warnings de lint
npm run lint

# 4. Formatar cÃ³digo
npm run format

# 5. Verificar status
git status

# 6. Fazer commit
git add -A
git commit -m "tipo: descriÃ§Ã£o da mudanÃ§a"

# 7. Push
git push origin main
```

---

PrÃ³ximos Passos

1. **Completar Sprint 1 (Semana 2)**
   - Controllers de usuÃ¡rio
   - Controllers de finanÃ§as
   - Testes E2E

2. **Sprint 2 - Banco de Dados**
   - Configurar PostgreSQL
   - Implementar migrations
   - Trocar repositÃ³rios em memÃ³ria

3. **Sprint 3 - Expandir API**
   - Eventos e apostas
   - Testes de integraÃ§Ã£o

---

Precisa de Ajuda?

1. Verificar  para questÃµes de autenticaÃ§Ã£o
2. Verificar  para endpoints
3. Consultar  para status
4. Abrir issue no repositÃ³rio

---

**Ãšltima atualizaÃ§Ã£o:** 14 de Novembro de 2025

Boa sorte! ğŸš€
